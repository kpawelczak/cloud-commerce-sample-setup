import './polyfills.server.mjs';
import{a as Tt,c as M,d as Ft}from"./chunk-6PUS6ORZ.mjs";import{H as z,R as Et,S as Q,g as ce,h as se}from"./chunk-LMNX2PFK.mjs";import{$ as ft,C as mt,Ca as Ct,E as Te,Ea as we,Ka as kt,La as vt,Ua as bt,Va as Ot,Y as _t,Za as qt,_ as gt,_a as St,b as ke,c as ve,d as be,e as Oe,ea as ht,g as lt,j as oe,l as qe,m as ut,p as Se,s as Ee,va as xt,x as pt,ya as Fe,za as yt}from"./chunk-L3T7QQFM.mjs";import{A as he,Ec as at,F as ie,Fc as dt,Ia as et,Ib as ot,J as xe,Ja as tt,P as ze,Ra as re,Ta as R,Ua as ye,Ub as ct,Vb as st,db as it,eb as rt,ha as Xe,ka as Je,kb as nt,lb as ne,uc as G,va as Ze,vc as Ce,y as Ke}from"./chunk-MYZEKFYU.mjs";import{$a as y,$b as v,$c as ge,A as Ae,Aa as Y,Cc as O,Dc as Z,Ec as Ge,Ed as te,Fa as U,Ga as $,H as $e,J as De,Jc as s,Jd as He,Ka as w,Kc as l,L,La as de,Lc as S,Md as fe,Oc as We,Pb as _,Qb as T,Ra as j,Rb as d,S as Re,Sa as D,Tb as J,V as Qe,Vb as Ne,X as V,Xb as u,Yb as p,Zb as b,_a as x,_b as k,_c as Ye,a as P,bc as F,ca as Le,dc as E,ec as m,f as Me,g as I,hc as H,ia as N,mc as le,nc as ue,oc as pe,pc as je,q as B,qb as Ve,qc as g,rc as me,sc as f,tc as _e,wb as c,wd as Ue,x as A,xa as W,xb as q,y as Be,yd as ee,zd as K}from"./chunk-IDQ3VQP7.mjs";import"./chunk-GHFNAT2I.mjs";var wt=(()=>{let r=class r{constructor(e,t,n,a){this.activeCartService=e,this.config=t,this.eventService=n,this.productSearchConnector=a,this.productAdded$=new Me,this.entries$=new I([]),this.softDeletedEntries$=new I({}),this.nonPurchasableProductError$=new I(null),this.hardDeleteTimeout=this.config.quickOrder?.list?.hardDeleteTimeout||7e3,this.quickOrderListLimit=0,this.clearDeleteTimeouts={}}ngOnDestroy(){this.clearDeletedEntries()}getEntries(){return this.entries$}searchProducts(e,t){if(this.productSearchConnector){let n={pageSize:t||Tt.quickOrder?.searchForm?.maxProducts};return this.productSearchConnector.search(e,n).pipe(A(a=>a.products||[]))}else return B([])}clearList(){this.entries$.next([])}canAdd(e,t){return e&&t?B(this.isProductOnTheList(e)||!this.isLimitExceeded(e,t)):e?B(this.isProductOnTheList(e)||!this.isLimitExceeded()):B(!this.isLimitExceeded())}setListLimit(e){this.quickOrderListLimit=e}loadEntries(e=[]){this.entries$.next(e)}updateEntryQuantity(e,t){let n=this.entries$.getValue()||[];n[e].quantity=t,this.entries$.next(n)}softDeleteEntry(e){this.entries$.pipe(V(1)).subscribe(t=>{let n=t;this.addSoftEntryDeletion(n[e],!0),n.splice(e,1),this.entries$.next(n)})}addProduct(e,t=1){let n=this.generateOrderEntry(e,t);this.addEntry(n)}getProductAdded(){return this.productAdded$}setProductAdded(e){this.productAdded$.next(e)}addToCart(){let e=[],t=[],n=this.eventService.get(ce).subscribe(a=>{(a.quantityAdded===0||a.quantityAdded&&a.quantityAdded<a.quantity)&&t.push(this.createQuickOrderResultEvent(a))});return n.add(this.eventService.get(se).subscribe(a=>{t.push(this.createQuickOrderResultEvent(a))})),this.getEntries().pipe(N(),W(a=>(e=a,this.activeCartService.addEntries(a),this.clearList(),this.activeCartService.isStable())),L(a=>a),A(()=>[e,t]),Y(()=>n.unsubscribe()))}getSoftDeletedEntries(){return this.softDeletedEntries$}restoreSoftDeletedEntry(e){let t=this.getSoftDeletedEntry(e);this.addEntry(t),this.hardDeleteEntry(e)}hardDeleteEntry(e){let t=this.getSoftDeletedEntry(e),n=this.softDeletedEntries$.getValue();t&&(delete n[e],this.softDeletedEntries$.next(n)),this.clearDeleteTimeout(e)}clearDeletedEntries(){Object.values(this.clearDeleteTimeouts).forEach(e=>e.unsubscribe()),this.softDeletedEntries$.next({}),this.clearDeleteTimeouts={}}getNonPurchasableProductError(){return this.nonPurchasableProductError$}setNonPurchasableProductError(e){this.nonPurchasableProductError$.next(e)}clearNonPurchasableProductError(){this.nonPurchasableProductError$.next(null)}addSoftEntryDeletion(e,t=!0){let n=this.softDeletedEntries$.getValue(),a=e?.product?.code;if(a&&(n[a]=e,this.softDeletedEntries$.next(n),t)){let C=$e(this.hardDeleteTimeout).subscribe(()=>{this.hardDeleteEntry(a)});this.clearDeleteTimeouts[a]=C}}getSoftDeletedEntry(e){return this.softDeletedEntries$.getValue()[e]}generateOrderEntry(e,t){return{basePrice:e.price,product:e,quantity:t,totalPrice:e.price}}addEntry(e){if(e?.product?.code&&!this.isProductOnTheList(e.product.code)&&this.isLimitExceeded())return;let t=this.entries$.getValue()||[],n=e.product?.stock?.stockLevel;if(n&&e.quantity&&e.quantity>n&&(e.quantity=n),e.product?.code&&this.isProductOnTheList(e.product.code)){let a=t.findIndex(h=>h.product?.code===e.product?.code),C=t[a].quantity;if(C&&e.quantity){t[a].quantity=C+e?.quantity;let h=t[a].quantity;h&&n&&h>n&&(t[a].quantity=n),this.entries$.next([...t])}}else this.entries$.next([...t,e]);this.productAdded$.next(e.product?.code)}isProductOnTheList(e){return!!(this.entries$.getValue()||[]).find(n=>n.product?.code===e)}isLimitExceeded(e,t){let n=this.entries$.getValue()||[],a=e&&t?this.getMissingProductIndex(n,e,t):0;return n.length+(a||0)>=this.quickOrderListLimit}getMissingProductIndex(e,t,n){return(n?.filter(C=>!e.map(h=>h.product?.code).includes(C.productCode))||[]).findIndex(C=>C.productCode===t)}createQuickOrderResultEvent(e){let t={productCode:e.productCode,quantity:e.quantity};if("entry"in e&&(t.entry=e.entry),"quantityAdded"in e&&(t.quantityAdded=e.quantityAdded),"error"in e&&e.error instanceof ze&&(t.error=e.error),t.error?.details?.length){let n=t.error?.details.some(a=>a.type==="InsufficientStockError");t.quantityAdded=n?0:t.quantity}return t}clearDeleteTimeout(e){let t=this.clearDeleteTimeouts[e];t&&(t.unsubscribe(),delete this.clearDeleteTimeouts[e])}};r.\u0275fac=function(t){return new(t||r)(w(z),w(ie),w(re),w(dt))},r.\u0275prov=U({token:r,factory:r.\u0275fac});let i=r;return i})(),Nt=[wt,{provide:M,useExisting:wt}],Ie=(()=>{let r=class r{constructor(e,t,n){this.quickOrderService=e,this.siteContextParamsService=t,this.statePersistenceService=n,this.subscription=new P,this.key="quick-order"}initSync(){this.subscription.add(this.statePersistenceService.syncWithStorage({key:this.key,state$:this.quickOrderService.getEntries(),context$:this.siteContextParamsService.getValues([Ze]),storageType:et.SESSION_STORAGE,onRead:e=>this.onRead(e)}))}onRead(e){e&&this.quickOrderService.loadEntries(e)}ngOnDestroy(){this.subscription.unsubscribe()}};r.\u0275fac=function(t){return new(t||r)(w(M),w(ot),w(tt))},r.\u0275prov=U({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})(),Pt=(()=>{let r=class r{static forRoot(){return{ngModule:r}}};r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=D({type:r}),r.\u0275inj=$({providers:[...Nt,Ie]});let i=r;return i})();var Bt=i=>({label:i});function Gt(i,r){i&1&&(u(0,"abbr",10),s(1,"cxTranslate"),g(2,"*"),p()),i&2&&H("title",l(1,1,"common.required"))}function Wt(i,r){i&1&&(k(0),_(1,Gt,3,3,"abbr",9),v()),i&2&&(c(),d("cxFeature","a11yRequiredAsterisks"))}function Yt(i,r){i&1&&(k(0),b(1,"input",11),s(2,"cxTranslate"),s(3,"cxTranslate"),v()),i&2&&(c(),H("placeholder",l(2,2,"quickOrderCartForm.productCodePlaceholder")),T("aria-label",l(3,4,"quickOrderCartForm.entryProductCode")))}function Ut(i,r){i&1&&(k(0),b(1,"input",12),s(2,"cxTranslate"),s(3,"cxTranslate"),v()),i&2&&(c(),H("placeholder",l(2,2,"quickOrderCartForm.productCodePlaceholder")),T("aria-label",l(3,4,"quickOrderCartForm.entryProductCode")))}function Ht(i,r){i&1&&(k(0),b(1,"input",13),s(2,"cxTranslate"),v()),i&2&&(c(),T("aria-label",l(2,1,"quickOrderCartForm.quantity")))}function Kt(i,r){i&1&&(k(0),b(1,"input",14),s(2,"cxTranslate"),v()),i&2&&(c(),T("aria-label",l(2,1,"quickOrderCartForm.quantity")))}function zt(i,r){if(i&1&&(k(0),u(1,"button",15),s(2,"async"),s(3,"async"),s(4,"cxTranslate"),g(5),s(6,"cxTranslate"),p(),v()),i&2){let o,e=m(2);c(),J("disabled",l(2,5,e.cartIsLoading$)),d("disabled",l(3,7,e.cartIsLoading$)||!(!(e.quickOrderForm==null||(o=e.quickOrderForm.get("productCode"))==null)&&o.value)||!(!(e.quickOrderForm==null||(o=e.quickOrderForm.get("quantity"))==null)&&o.value)),T("aria-label",l(4,9,"quickOrderCartForm.addToCart")),c(4),f(" ",l(6,11,"quickOrderCartForm.add")," ")}}function Xt(i,r){if(i&1&&(b(0,"cx-form-errors",18),s(1,"cxTranslate")),i&2){let o=m(3);d("translationParams",O(4,Bt,l(1,2,"quickOrderCartForm.productCodeLabel")))("control",o.quickOrderForm.get("productCode"))}}function Jt(i,r){if(i&1&&b(0,"cx-form-errors",19),i&2){let o=m(3);d("control",o.quickOrderForm.get("productCode"))}}function Zt(i,r){if(i&1&&(b(0,"cx-form-errors",18),s(1,"cxTranslate")),i&2){let o=m(3);d("translationParams",O(4,Bt,l(1,2,"quickOrderCartForm.quantityLabel")))("control",o.quickOrderForm.get("quantity"))}}function ei(i,r){if(i&1&&b(0,"cx-form-errors",19),i&2){let o=m(3);d("control",o.quickOrderForm.get("quantity"))}}function ti(i,r){if(i&1&&(k(0),u(1,"button",15),s(2,"async"),s(3,"async"),s(4,"cxTranslate"),g(5),s(6,"cxTranslate"),p(),_(7,Xt,2,6,"cx-form-errors",16)(8,Jt,1,1,"cx-form-errors",17)(9,Zt,2,6,"cx-form-errors",16)(10,ei,1,1,"cx-form-errors",17),v()),i&2){let o=m(2);c(),J("disabled",l(2,9,o.cartIsLoading$)),d("disabled",l(3,11,o.cartIsLoading$)),T("aria-label",l(4,13,"quickOrderCartForm.addToCart")),c(4),f(" ",l(6,15,"quickOrderCartForm.add")," "),c(2),d("cxFeature","formErrorsDescriptiveMessages"),c(),d("cxFeature","!formErrorsDescriptiveMessages"),c(),d("cxFeature","formErrorsDescriptiveMessages"),c(),d("cxFeature","!formErrorsDescriptiveMessages")}}function ii(i,r){if(i&1){let o=F();k(0),u(1,"div",1),g(2),s(3,"cxTranslate"),p(),u(4,"div",2)(5,"form",3),E("ngSubmit",function(){x(o);let t=m();return y(t.applyQuickOrder())}),u(6,"div",4)(7,"span",5)(8,"label",6),g(9),s(10,"cxTranslate"),_(11,Wt,2,1,"ng-container",7),p(),_(12,Yt,4,6,"ng-container",7)(13,Ut,4,6,"ng-container",7),p(),u(14,"span",8)(15,"label",6),g(16),s(17,"cxTranslate"),p(),_(18,Ht,3,3,"ng-container",7)(19,Kt,3,3,"ng-container",7),p(),_(20,zt,7,13,"ng-container",7)(21,ti,11,17,"ng-container",7),p()()(),v()}if(i&2){let o=m();c(2),f(" ",l(3,11,"quickOrderCartForm.title")," "),c(3),d("formGroup",o.quickOrderForm),c(4),f(" ",l(10,13,"quickOrderCartForm.productCodeLabel")," "),c(2),d("cxFeature","!a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields"),c(),d("cxFeature","a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields"),c(),d("cxFeature","!a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields"),c(3),f(" ",l(17,15,"quickOrderCartForm.quantityLabel")," "),c(2),d("cxFeature","a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields"),c(),d("cxFeature","!a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields"),c(),d("cxFeature","a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields"),c(),d("cxFeature","!a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields")}}var ri=["quickOrderInput"],At=i=>({limit:i}),X=i=>({count:i}),ni=i=>({id:i});function oi(i,r){if(i&1){let o=F();u(0,"button",9),s(1,"cxTranslate"),s(2,"cxTranslate"),E("click",function(t){x(o);let n=m();return y(n.clear(t))})("keydown.enter",function(t){x(o);let n=m();return y(n.clear(t))}),b(3,"cx-icon",10),p()}if(i&2){let o=m();T("aria-label",l(1,3,"common.reset"))("title",l(2,5,"common.reset")),c(3),d("type",o.iconTypes.RESET)}}function ci(i,r){if(i&1&&(u(0,"button",11),s(1,"cxTranslate"),b(2,"cx-icon",10),p()),i&2){let o=m();T("aria-label",l(1,2,"common.search")),c(2),d("type",o.iconTypes.SEARCH)}}function si(i,r){i&1&&(u(0,"span",12),g(1),s(2,"cxTranslate"),p()),i&2&&(c(),f(" ",l(2,1,"quickOrderForm.listLimitReached")," "))}function ai(i,r){if(i&1&&b(0,"cx-media",24),i&2){let o=m().$implicit;d("alt",o.name)("container",o.images==null?null:o.images.PRIMARY)}}function di(i,r){if(i&1){let o=F();u(0,"li",18)(1,"button",19),E("blur",function(t){x(o);let n=m(3);return y(n.onBlur(t))})("mousedown",function(t){let n=x(o).$implicit,a=m(3);return y(a.add(n,t))})("keydown.arrowdown",function(t){x(o);let n=m(3);return y(n.focusNextChild(t))})("keydown.arrowup",function(t){x(o);let n=m(3);return y(n.focusPreviousChild(t))})("keydown.enter",function(t){let n=x(o).$implicit,a=m(3);return y(a.add(n,t))})("keydown.escape",function(t){x(o);let n=m(3);return y(n.clear(t))}),_(2,ai,1,2,"cx-media",20),b(3,"div",21),u(4,"span",22),g(5),s(6,"cxTranslate"),p(),u(7,"span",23),g(8),p()()()}if(i&2){let o=r.$implicit,e=m(3);c(),J("has-media",e.config==null||e.config.quickOrder==null||e.config.quickOrder.searchForm==null?null:e.config.quickOrder.searchForm.displayProductImages),c(),d("ngIf",e.config==null||e.config.quickOrder==null||e.config.quickOrder.searchForm==null?null:e.config.quickOrder.searchForm.displayProductImages),c(),d("innerHTML",o.name,Ve),c(2),f(" ",S(6,6,"quickOrderForm.id",O(9,ni,o.code))," "),c(3),me(o.price==null?null:o.price.formattedValue)}}function li(i,r){if(i&1&&(u(0,"ul",16),_(1,di,9,11,"li",17),p()),i&2){let o=m(2);c(),d("ngForOf",o.results)}}function ui(i,r){i&1&&(u(0,"span",25),g(1),s(2,"cxTranslate"),p()),i&2&&(c(),f(" ",l(2,1,"quickOrderForm.noResults")," "))}function pi(i,r){if(i&1&&(u(0,"div",13),_(1,li,2,1,"ul",14)(2,ui,3,3,"span",15),p()),i&2){let o=m();c(),d("ngIf",o.results.length),c(),d("ngIf",o.noResults)}}var mi=["cx-quick-order-item",""],_i=(i,r)=>({disabled:i,"img-missing":r}),Mt=i=>({cxRoute:"product",params:i}),gi=i=>({disabled:i});function fi(i,r){if(i&1&&b(0,"tr",10),i&2){let o=r.$implicit,e=r.index,t=m(2);d("entry",o)("index",e)("loading",t.loading)}}function hi(i,r){if(i&1&&(u(0,"table",1)(1,"caption",2),g(2),s(3,"cxTranslate"),p(),u(4,"thead")(5,"tr",3)(6,"th",4),g(7),s(8,"cxTranslate"),p(),u(9,"th",5),g(10),s(11,"cxTranslate"),p(),u(12,"th",6),g(13),s(14,"cxTranslate"),p(),u(15,"th",7),g(16),s(17,"cxTranslate"),p()()(),u(18,"tbody",8),_(19,fi,1,3,"tr",9),p()()),i&2){let o=m();c(2),f(" ",l(3,6,"quickOrderTable.caption")," "),c(5),f(" ",l(8,8,"quickOrderTable.product")," "),c(3),f(" ",l(11,10,"quickOrderTable.price")," "),c(3),f(" ",l(14,12,"quickOrderTable.quantity")," "),c(3),f(" ",l(17,14,"quickOrderTable.actions")," "),c(3),d("ngForOf",o.entries)}}var xi=["quickOrderForm"],Pe=i=>({name:i}),$t=(i,r)=>({name:i,code:r}),yi=(i,r,o)=>({name:i,code:r,quantityAdded:o});function Ci(i,r){if(i&1&&(k(0),b(1,"cx-message",3),s(2,"cxTranslate"),v()),i&2){let o=m(2).ngIf,e=m();c(),d("text",S(2,3,"quickOrderList.errors.listIsFull",O(6,X,o.length)))("isVisibleCloseButton",!1)("type",e.globalMessageType.MSG_TYPE_ERROR)}}function ki(i,r){if(i&1&&(k(0),_(1,Ci,3,8,"ng-container",2),v()),i&2){let o,e=m(2);c(),d("ngIf",e.quickOrderForm==null||e.quickOrderForm.form==null||(o=e.quickOrderForm.form.get("product"))==null?null:o.dirty)}}function vi(i,r){if(i&1&&(k(0),_(1,ki,2,1,"ng-container",2),s(2,"async"),v()),i&2){let o=m();c(),d("ngIf",!l(2,1,o.canAddProduct()))}}function bi(i,r){if(i&1){let o=F();k(0),u(1,"cx-message",4),s(2,"cxTranslate"),E("closeMessage",function(){x(o);let t=m();return y(t.clearAddToCartInformation())}),p(),v()}if(i&2){let o=m();c(),d("text",l(2,2,"quickOrderList.informations.addProductBeforeAddingToCart"))("type",o.globalMessageType.MSG_TYPE_ERROR)}}function Oi(i,r){if(i&1){let o=F();k(0),u(1,"cx-message",5),s(2,"cxTranslate"),E("closeMessage",function(){x(o);let t=m();return y(t.clearNonPurchasableError())}),p(),v()}if(i&2){let o=r.ngIf,e=m();c(),d("text",S(2,2,"quickOrderList.errors.nonPurchasableError",O(5,Pe,o.name)))("type",e.globalMessageType.MSG_TYPE_ERROR)}}function qi(i,r){if(i&1){let o=F();u(0,"cx-message",7),s(1,"cxTranslate"),s(2,"cxTranslate"),s(3,"cxTranslate"),E("buttonAction",function(){let t=x(o).$implicit,n=m(2);return y(n.undoDeletion(t.value))})("closeMessage",function(){let t=x(o).$implicit,n=m(2);return y(n.clearDeletion(t.value))}),p()}if(i&2){let o=r.$implicit,e=m(2);d("actionButtonText",l(1,4,"quickOrderList.undo"))("actionButtonMessage",S(2,6,"quickOrderList.revokeUndo",O(12,Pe,o.value.product==null?null:o.value.product.name)))("text",S(3,9,"quickOrderList.productWasDeleted",O(14,Pe,o.value.product==null?null:o.value.product.name)))("type",e.globalMessageType.MSG_TYPE_CONFIRMATION)}}function Si(i,r){if(i&1&&(k(0),_(1,qi,4,16,"cx-message",6),s(2,"keyvalue"),v()),i&2){let o=r.ngIf;c(),d("ngForOf",l(2,1,o))}}function Ei(i,r){if(i&1&&(u(0,"li",13)(1,"span"),g(2),s(3,"cxTranslate"),p()()),i&2){let o=r.$implicit;c(2),f(" ",S(3,1,"quickOrderList.errors.productIsOutOfStock",Z(4,$t,o.entry.product.name,o.entry.product.code))," ")}}function Ti(i,r){if(i&1){let o=F();u(0,"cx-message",9),s(1,"cxTranslate"),s(2,"cxTranslate"),E("closeMessage",function(){x(o);let t=m(2);return y(t.clearErrors())}),u(3,"ul",10),_(4,Ei,4,7,"li",11),p(),u(5,"div",12),g(6),s(7,"cxTranslate"),p()()}if(i&2){let o=m().ngIf,e=m();d("accordionText",l(1,5,"quickOrderList.errors.reviewErrors"))("text",l(2,7,"quickOrderList.errorProceedingToCart"))("type",e.globalMessageType.MSG_TYPE_ERROR),c(4),d("ngForOf",o),c(2),f(" ",S(7,9,"quickOrderList.errors.outOfStockErrorFound",O(12,X,o.length))," ")}}function Fi(i,r){if(i&1&&(k(0),_(1,Ti,8,14,"cx-message",8),v()),i&2){let o=r.ngIf;c(),d("ngIf",o.length)}}function wi(i,r){if(i&1&&(u(0,"li",18)(1,"span"),g(2),s(3,"cxTranslate"),p()()),i&2){let o=r.$implicit;c(2),f(" ",S(3,1,"quickOrderList.warnings.productWasReduced",Ge(4,yi,o.entry.product.name,o.entry.product.code,o.quantityAdded))," ")}}function Ii(i,r){if(i&1){let o=F();u(0,"cx-message",15),s(1,"cxTranslate"),s(2,"cxTranslate"),E("closeMessage",function(){x(o);let t=m(2);return y(t.clearWarnings())}),u(3,"ul",16),_(4,wi,4,8,"li",17),p(),u(5,"div",12),g(6),s(7,"cxTranslate"),p()()}if(i&2){let o=m().ngIf,e=m();d("accordionText",l(1,5,"quickOrderList.warnings.reviewWarnings"))("text",l(2,7,"quickOrderList.warningProceedingToCart"))("type",e.globalMessageType.MSG_TYPE_WARNING),c(4),d("ngForOf",o),c(2),f(" ",S(7,9,"quickOrderList.warnings.reduceWarningFound",O(12,X,o.length))," ")}}function Pi(i,r){if(i&1&&(k(0),_(1,Ii,8,14,"cx-message",14),v()),i&2){let o=r.ngIf;c(),d("ngIf",o.length)}}function Mi(i,r){if(i&1&&(u(0,"li",23)(1,"span"),g(2),s(3,"cxTranslate"),p()()),i&2){let o=r.$implicit;c(2),me(S(3,1,"quickOrderList.successes.productAddedToCart",Z(4,$t,o.product.name,o.product.code)))}}function Bi(i,r){if(i&1){let o=F();u(0,"cx-message",20),s(1,"cxTranslate"),E("closeMessage",function(){x(o);let t=m(2);return y(t.clearSuccesses())}),u(2,"ul",21),_(3,Mi,4,7,"li",22),p(),u(4,"div",12),g(5),s(6,"cxTranslate"),p()()}if(i&2){let o=m().ngIf,e=m();d("text",l(1,4,"quickOrderList.successfullyAddedToCart"))("type",e.globalMessageType.MSG_TYPE_CONFIRMATION),c(3),d("ngForOf",o),c(2),f(" ",S(6,6,"quickOrderList.successes.addedToCartFound",O(9,X,o.length))," ")}}function Ai(i,r){if(i&1&&(k(0),_(1,Bi,7,11,"cx-message",19),v()),i&2){let o=r.ngIf;c(),d("ngIf",o.length)}}function $i(i,r){if(i&1){let o=F();u(0,"button",33),s(1,"async"),s(2,"cxTranslate"),E("click",function(){x(o);let t=m(3);return y(t.clear())}),g(3),s(4,"cxTranslate"),p()}if(i&2){let o=m(3);d("disabled",!l(1,3,o.isCartStable$)),T("aria-label",l(2,5,"quickOrderList.emptyList")),c(3),f(" ",l(4,7,"quickOrderList.emptyList")," ")}}function Di(i,r){if(i&1){let o=F();k(0),u(1,"div",24)(2,"h2"),g(3),s(4,"cxTranslate"),p(),u(5,"p"),g(6),s(7,"cxTranslate"),p()(),u(8,"div",25),b(9,"cx-quick-order-form",26,0),p(),u(11,"div",27),b(12,"cx-quick-order-table",28),s(13,"async"),p(),u(14,"div",29)(15,"div",30),_(16,$i,5,9,"button",31),p(),u(17,"div",30)(18,"cx-progress-button",32),s(19,"cxTranslate"),s(20,"async"),E("clickEvent",function(){let t=x(o).ngIf,n=m(2);return y(n.addToCart(t))}),g(21),s(22,"cxTranslate"),p()()(),v()}if(i&2){let o=r.ngIf,e=m().ngIf,t=m();c(3),f(" ",l(4,11,"quickOrderList.header")," "),c(3),f(" ",S(7,13,"quickOrderList.subHeader",O(24,At,e))," "),c(3),d("limit",e),c(3),d("entries",o)("loading",!l(13,16,t.isCartStable$)),c(4),d("ngIf",o.length),c(2),Ne("btn-block add-button"),d("ariaLabel",l(19,18,"quickOrderList.addToCart"))("loading",!l(20,20,t.isCartStable$)),c(3),f(" ",l(22,22,"quickOrderList.addToCart")," ")}}function Ri(i,r){if(i&1&&(k(0),_(1,Di,23,26,"ng-container",2),s(2,"async"),v()),i&2){let o=m();c(),d("ngIf",l(2,1,o.entries$))}}var Qi=(()=>{let r=class r{constructor(e,t,n,a){this.activeCartService=e,this.eventService=t,this.formBuilder=n,this.globalMessageService=a,this.featureConfig=de(it),this.cartIsLoading$=this.activeCartService.isStable().pipe(A(C=>!C)),this.cart$=this.activeCartService.getActive(),this.min=1,this.subscription=new P,this.cartEventsSubscription=new P,this.minQuantityValue=1}ngOnInit(){this.buildForm(),this.watchQuantityChange()}ngOnDestroy(){this.subscription?.unsubscribe(),this.cartEventsSubscription?.unsubscribe()}applyQuickOrder(){if(this.quickOrderForm.invalid){this.quickOrderForm.markAllAsTouched();return}let e=this.quickOrderForm.get("productCode")?.value,t=this.quickOrderForm.get("quantity")?.value;this.watchAddEntrySuccessEvent(),this.featureConfig.isEnabled("cartQuickOrderRemoveListeningToFailEvent")||this.watchAddEntryFailEvent(),e&&t&&this.activeCartService.addEntry(e,t)}buildForm(){let e=!this.featureConfig.isEnabled("a11yDisabledCouponAndQuickOrderActionButtonsInsteadOfRequiredFields");this.quickOrderForm=this.formBuilder.group({productCode:["",e?[ve.required]:[]],quantity:[this.minQuantityValue,{updateOn:"blur",validators:e?[ve.required]:[]}]})}watchQuantityChange(){this.subscription.add(this.quickOrderForm.get("quantity")?.valueChanges.subscribe(e=>this.quickOrderForm.get("quantity")?.setValue(this.getValidCount(e),{emitEvent:!1})))}watchAddEntrySuccessEvent(){this.cartEventsSubscription.add(this.eventService.get(ce).pipe(N()).subscribe(e=>{let t="quickOrderCartForm.stockLevelReached",n,a=R.MSG_TYPE_WARNING;e.quantityAdded&&(t=e.quantityAdded>1?"quickOrderCartForm.entriesWereAdded":"quickOrderCartForm.entryWasAdded",n=e.quantityAdded>1?"quickOrderCartForm.products":"quickOrderCartForm.product",a=R.MSG_TYPE_CONFIRMATION),this.globalMessageService.add({key:t,params:{product:e?.entry?.product?.name||n,quantity:e.quantityAdded}},a),this.resetForm()}))}watchAddEntryFailEvent(){this.cartEventsSubscription.add(this.eventService.get(se).pipe(N()).subscribe(()=>{this.globalMessageService.add({key:"quickOrderCartForm.noResults"},R.MSG_TYPE_ERROR)}))}getValidCount(e){return(e<this.min||!e)&&(e=this.min),e}resetForm(){this.quickOrderForm.reset()}};r.\u0275fac=function(t){return new(t||r)(q(z),q(re),q(mt),q(ye))},r.\u0275cmp=j({type:r,selectors:[["cx-cart-quick-order-form"]],decls:2,vars:3,consts:[[4,"ngIf"],[1,"cx-cart-quick-order-form-title"],[1,"form-group"],[3,"ngSubmit","formGroup"],[1,"cx-cart-quick-order-form-container"],[1,"cx-cart-quick-order-form-productID"],[1,"cx-cart-quick-order-form-label"],[4,"cxFeature"],[1,"cx-cart-quick-order-form-qty"],["class","text-decoration-none",3,"title",4,"cxFeature"],[1,"text-decoration-none",3,"title"],["formControlName","productCode","type","text",1,"form-control","input-product-code",3,"placeholder"],["aria-required","true","formControlName","productCode","required","true","type","text",1,"form-control","input-product-code",3,"placeholder"],["formControlName","quantity","type","number",1,"form-control","input-quantity"],["aria-required","true","formControlName","quantity","required","true","type","number",1,"form-control","input-quantity"],["type","submit",1,"btn","btn-block","btn-secondary","apply-quick-order-button",3,"disabled"],[3,"translationParams","control",4,"cxFeature"],[3,"control",4,"cxFeature"],[3,"translationParams","control"],[3,"control"]],template:function(t,n){t&1&&(_(0,ii,22,17,"ng-container",0),s(1,"async")),t&2&&d("ngIf",l(1,1,n.cart$))},dependencies:[K,qe,ke,ut,be,Oe,pt,Se,Ee,Ct,rt,te,G],encapsulation:2,changeDetection:0});let i=r;return i})(),Li=(()=>{let r=class r{};r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=D({type:r}),r.\u0275inj=$({providers:[xe({cmsComponents:{CartQuickOrderFormComponent:{component:Qi}}})],imports:[fe,Te,Ce,we,nt]});let i=r;return i})(),Vi=(()=>{let r=class r{constructor(e,t){this.quickOrderService=e,this.productConnector=t,this.type=Et.QUICK_ORDER,this.logger=de(Je)}getEntries(){return this.quickOrderService.getEntries()}addEntries(e){return De(e.map(t=>this.quickOrderService.canAdd(t.productCode,e).pipe(W(n=>n?this.productConnector.get(t.productCode).pipe(L(a=>!!a),Y(a=>{this.quickOrderService.addProduct(a,t.quantity)}),A(a=>this.handleResults(a,t)),Re(a=>B(this.handleErrors(a,t.productCode)))):B({productCode:t.productCode,statusCode:Q.LIMIT_EXCEEDED}))))).pipe(Ae(),V(e.length))}handleResults(e,t){return e.stock?.stockLevel&&t.quantity>e.stock.stockLevel?{productCode:t.productCode,productName:e?.name,statusCode:Q.LOW_STOCK,quantity:t.quantity,quantityAdded:e.stock.stockLevel}:e.stock?.stockLevelStatus==="outOfStock"?{productCode:t.productCode,statusCode:Q.NO_STOCK,productName:e?.name}:{productCode:t.productCode,statusCode:Q.SUCCESS}}handleErrors(e,t){return e?.error?.errors[0].type==="UnknownIdentifierError"?{productCode:t,statusCode:Q.UNKNOWN_IDENTIFIER}:(Ye()&&this.logger.warn("Unrecognized cart add entry action type while mapping messages",e),{productCode:t,statusCode:Q.UNKNOWN_ERROR})}};r.\u0275fac=function(t){return new(t||r)(w(M),w(at))},r.\u0275prov=U({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})(),ae="quick-order-searchbox-is-active",Ni=(()=>{let r=class r{constructor(e,t,n,a){this.config=e,this.cd=t,this.quickOrderService=n,this.winRef=a,this.iconTypes=_t,this.isSearching=!1,this.noResults=!1,this.results=[],this.subscription=new P,this.searchSubscription=new P,ne("a11yTruncatedTextForResponsiveView"),ne("a11yPreventSRFocusOnHiddenElements")}ngOnInit(){this.buildForm(),this.subscription.add(this.watchProductAdd()),this.subscription.add(this.watchQueryChange())}onBlur(e){setTimeout(()=>{this.isSuggestionFocused()||this.blurSuggestionBox(e)})}clear(e){e?.preventDefault(),this.isResultsBoxOpen()&&this.toggleBodyClass(ae,!1),this.form.get("product")?.value&&this.form.reset(),this.close(),this.cd?.detectChanges()}add(e,t){if(t?.preventDefault(),e.multidimensional){this.quickOrderService.setNonPurchasableProductError(e),this.clear();return}else this.quickOrderService.clearNonPurchasableProductError();this.quickOrderService.addProduct(e),this.quickOrderInput.nativeElement.focus()}addProduct(e){this.quickOrderService.canAdd().pipe(V(1)).subscribe(t=>{if(t){if(this.results.length===1)this.add(this.results[0],e);else if(this.getFocusedIndex()!==-1){let n=this.results[this.getFocusedIndex()];this.add(n,e)}}})}focusNextChild(e){if(e.preventDefault(),!this.results.length)return;let[t,n]=[this.getResultElements(),this.getFocusedIndex()];t.length&&(n>=t.length-1?t[0].focus():t[n+1].focus())}focusPreviousChild(e){if(e.preventDefault(),!this.results.length)return;let[t,n]=[this.getResultElements(),this.getFocusedIndex()];t.length&&(n<1?t[t.length-1].focus():t[n-1].focus())}isResultsBoxOpen(){return this.winRef?!!this.winRef.document.querySelector(`.${ae}`):!1}canAddProduct(){return this.quickOrderService.canAdd()}open(){this.toggleBodyClass(ae,!0)}getResultElements(){return this.winRef?Array.from(this.winRef.document.querySelectorAll(".quick-order-results-products > li button")):[]}blurSuggestionBox(e){this.toggleBodyClass(ae,!1),e&&e.target&&e.target.blur()}getFocusedElement(){if(this.winRef)return this.winRef.document.activeElement}getFocusedIndex(){return this.getResultElements().indexOf(this.getFocusedElement())}isSuggestionFocused(){return this.getResultElements().includes(this.getFocusedElement())}toggleBodyClass(e,t){this.winRef&&(t===void 0?this.winRef.document.body.classList.toggle(e):t?this.winRef.document.body.classList.add(e):this.winRef.document.body.classList.remove(e))}buildForm(){let e=new lt({});e.setControl("product",new oe(null)),this.form=e}isEmpty(e){return e?.trim()===""||e==null}watchQueryChange(){return this.form.valueChanges.pipe(Le(),Qe(300),L(e=>this.config?.quickOrder?.searchForm?this.isEmpty(e.product)?(this.clear(),!1):!!e.product&&e.product.length>=this.config.quickOrder?.searchForm?.minCharactersBeforeRequest:e)).subscribe(e=>{this.searchProducts(e.product)})}searchProducts(e){this.searchSubscription.add(this.canAddProduct().pipe(L(Boolean),W(()=>this.quickOrderService.searchProducts(e,this.config?.quickOrder?.searchForm?.maxProducts).pipe(V(1)))).subscribe(t=>{this.results=t,this.results.length?(this.noResults=!1,this.open()):this.noResults=!0,this.cd?.detectChanges()}))}clearResults(){this.results=[]}close(){this.resetSearchSubscription(),this.clearResults(),this.noResults=!1}resetSearchSubscription(){this.searchSubscription.unsubscribe(),this.searchSubscription=new P}watchProductAdd(){return this.quickOrderService.getProductAdded().subscribe(()=>this.clear())}ngOnDestroy(){this.subscription.unsubscribe()}};r.\u0275fac=function(t){return new(t||r)(q(ie),q(ge),q(M),q(Xe))},r.\u0275cmp=j({type:r,selectors:[["cx-quick-order-form"]],viewQuery:function(t,n){if(t&1&&le(ri,5),t&2){let a;ue(a=pe())&&(n.quickOrderInput=a.first)}},inputs:{limit:"limit"},decls:17,vars:28,consts:[["quickOrderInput",""],["searchIcon",""],[1,"quick-order-form-container",3,"formGroup"],["role","combobox",1,"quick-order-form-input"],["aria-controls","quick-order-search-results","aria-describedby","quickOrderFormInitialDescription","formControlName","product","type","text",1,"form-control",3,"blur","focus","keydown.arrowdown","keydown.arrowup","keydown.enter","keydown.escape","placeholder"],["class","quick-order-form-reset-icon",3,"click","keydown.enter",4,"ngIf","ngIfElse"],["class","list-limit-reached-text","role","alert",4,"ngIf"],["class","quick-order-results","role","dialog","id","quick-order-search-results",4,"ngIf"],["aria-live","polite","id","quickOrderFormInitialDescription","aria-atomic","true",1,"cx-visually-hidden","quick-order-form-description"],[1,"quick-order-form-reset-icon",3,"click","keydown.enter"],[3,"type"],["tabindex","-1",1,"quick-order-form-search-icon"],["role","alert",1,"list-limit-reached-text"],["role","dialog","id","quick-order-search-results",1,"quick-order-results"],["class","quick-order-results-products","role","listbox",4,"ngIf"],["class","quick-order-no-results",4,"ngIf"],["role","listbox",1,"quick-order-results-products"],["class","quick-order-results-product-container",4,"ngFor","ngForOf"],[1,"quick-order-results-product-container"],["role","option",1,"quick-order-results-product",3,"blur","mousedown","keydown.arrowdown","keydown.arrowup","keydown.enter","keydown.escape"],["class","media","format","thumbnail","role","presentation",3,"alt","container",4,"ngIf"],[1,"name",3,"innerHTML"],[1,"id"],[1,"price"],["format","thumbnail","role","presentation",1,"media",3,"alt","container"],[1,"quick-order-no-results"]],template:function(t,n){if(t&1){let a=F();u(0,"form",2)(1,"div",3),s(2,"cxTranslate"),u(3,"input",4,0),s(5,"cxTranslate"),s(6,"cxTranslate"),E("blur",function(h){return x(a),y(n.onBlur(h))})("focus",function(){return x(a),y(n.open())})("keydown.arrowdown",function(h){return x(a),y(n.focusNextChild(h))})("keydown.arrowup",function(h){return x(a),y(n.focusPreviousChild(h))})("keydown.enter",function(h){return x(a),y(n.addProduct(h))})("keydown.escape",function(h){return x(a),y(n.clear(h))}),p(),_(7,oi,4,7,"button",5)(8,ci,3,4,"ng-template",null,1,We)(10,si,3,3,"span",6),s(11,"async"),p(),_(12,pi,3,2,"div",7),p(),u(13,"label",8),g(14),s(15,"cxTranslate"),s(16,"cxTranslate"),p()}if(t&2){let a,C,h=je(9);d("formGroup",n.form),c(),T("aria-label",l(2,10,"quickOrderForm.quickOrderSearch")),c(2),H("placeholder",l(5,12,"quickOrderForm.placeholder")),T("aria-label",S(6,14,"quickOrderForm.searchBoxLabel",O(24,At,n.limit))),c(4),d("ngIf",(a=n.form.get("product"))==null?null:a.value)("ngIfElse",h),c(3),d("ngIf",!l(11,17,n.canAddProduct())&&((C=n.form.get("product"))==null?null:C.dirty)),c(2),d("ngIf",n.isResultsBoxOpen()),c(2),_e(" ",n.results.length?S(15,19,"quickOrderForm.productsResults",O(26,X,n.results.length)):""," ",l(16,22,"quickOrderForm.initialDescription"),`
`)}},dependencies:[ee,K,gt,Fe,qe,ke,be,Oe,Se,Ee,te,G],encapsulation:2,changeDetection:0});let i=r;return i})(),ji=(()=>{let r=class r{get entry(){return this._entry}set entry(e){this._entry=e,this.quantityControl=new oe(this.entry.quantity,{updateOn:"blur"})}constructor(e,t){this.cd=e,this.quickOrderService=t,this.loading=!1,this.subscription=new P,ne("a11yCartItemsLinksStyles")}ngOnInit(){this.subscription.add(this.quantityControl.valueChanges.subscribe(()=>{this.quickOrderService.updateEntryQuantity(this.index,this.quantityControl.value)})),this.subscription.add(this.watchProductAdd())}removeEntry(){this.quickOrderService.softDeleteEntry(this.index),this.cd.detectChanges()}watchProductAdd(){return this.quickOrderService.getProductAdded().subscribe(e=>{e===this.entry.product?.code&&(this.quantityControl=new oe(this.entry.quantity),this.cd.detectChanges())})}ngOnDestroy(){this.subscription?.unsubscribe()}};r.\u0275fac=function(t){return new(t||r)(q(ge),q(M))},r.\u0275cmp=j({type:r,selectors:[["","cx-quick-order-item",""],["cx-quick-order-item"]],inputs:{entry:"entry",index:"index",loading:"loading"},attrs:mi,decls:30,vars:41,consts:[["role","cell"],[1,"cx-table-item-container"],["tabindex","-1",3,"ngClass","routerLink"],["format","cartIcon",3,"container","alt"],[1,"cx-info"],[1,"cx-name"],[1,"cx-link",3,"ngClass","routerLink"],[1,"cx-code"],["role","cell",1,"cx-price"],[1,"cx-mobile-header"],[1,"cx-value"],["role","cell",1,"cx-quantity"],[3,"control","max","readonly"],["role","cell",1,"cx-actions"],[1,"btn","btn-tertiary",3,"click","disabled"]],template:function(t,n){t&1&&(u(0,"td",0)(1,"div",1)(2,"a",2),s(3,"cxUrl"),b(4,"cx-media",3),p(),u(5,"div",4)(6,"div",5)(7,"a",6),s(8,"cxUrl"),g(9),p()(),u(10,"div",7),g(11),s(12,"cxTranslate"),p()()()(),u(13,"td",8)(14,"div",9),g(15),s(16,"cxTranslate"),p(),u(17,"div",10),g(18),p()(),u(19,"td",11)(20,"div",9),g(21),s(22,"cxTranslate"),p(),u(23,"div",10),b(24,"cx-item-counter",12),p()(),u(25,"td",13)(26,"button",14),s(27,"cxTranslate"),E("click",function(){return n.removeEntry()}),g(28),s(29,"cxTranslate"),p()()),t&2&&(c(2),d("ngClass",Z(32,_i,n.loading,!(!(n.entry==null||n.entry.product==null||n.entry.product.images==null)&&n.entry.product.images.PRIMARY)))("routerLink",l(3,18,O(35,Mt,n.entry.product))),c(2),d("container",n.entry==null||n.entry.product==null||n.entry.product.images==null?null:n.entry.product.images.PRIMARY)("alt",n.entry==null||n.entry.product==null?null:n.entry.product.name),c(3),d("ngClass",O(37,gi,n.loading))("routerLink",l(8,20,O(39,Mt,n.entry.product))),c(2),f("",(n.entry.product==null?null:n.entry.product.name)||"-"," "),c(2),_e(" ",l(12,22,"quickOrderTable.id")," ",n.entry.product==null?null:n.entry.product.code," "),c(4),f(" ",l(16,24,"quickOrderTable.itemPrice")," "),c(3),f(" ",(n.entry.basePrice==null?null:n.entry.basePrice.formattedValue)||"-"," "),c(3),f(" ",l(22,26,"quickOrderTable.qty")," "),c(3),d("control",n.quantityControl)("max",n.entry.product==null||n.entry.product.stock==null?null:n.entry.product.stock.stockLevel)("readonly",n.loading),c(2),d("disabled",n.loading),T("aria-label",l(27,28,"common.remove")),c(2),f(" ",l(29,30,"common.remove")," "))},dependencies:[Ue,kt,Fe,Ke,G,ct],encapsulation:2,changeDetection:0});let i=r;return i})(),Gi=(()=>{let r=class r{constructor(){this.entries=[],this.loading=!1}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=j({type:r,selectors:[["cx-quick-order-table"]],inputs:{entries:"entries",loading:"loading"},decls:1,vars:1,consts:[["class","cx-quick-order-table-wrapper","role","table",4,"ngIf"],["role","table",1,"cx-quick-order-table-wrapper"],[1,"cx-visually-hidden"],["role","row",1,"cx-item-list-header","cx-quick-order-table-header"],["role","columnheader",1,"cx-item-list-desc"],["role","columnheader",1,"cx-item-list-price"],["role","columnheader",1,"cx-item-list-qty"],["role","columnheader",1,"cx-item-list-actions"],[1,"cx-item-list-items"],["cx-quick-order-item","","class","cx-item-list-row cx-quick-order-table-row",3,"entry","index","loading",4,"ngFor","ngForOf"],["cx-quick-order-item","",1,"cx-item-list-row","cx-quick-order-table-row",3,"entry","index","loading"]],template:function(t,n){t&1&&_(0,hi,20,16,"table",0),t&2&&d("ngIf",(n.entries==null?null:n.entries.length)>0)},dependencies:[ee,K,ji,G],encapsulation:2,changeDetection:0});let i=r;return i})(),Wi=(()=>{let r=class r{constructor(e,t,n,a,C){this.activeCartService=e,this.component=t,this.globalMessageService=n,this.quickOrderService=a,this.quickOrderStatePersistenceService=C,this.quickOrderListLimit$=this.component.data$.pipe(A(h=>h.quickOrderListLimit),Y(h=>{h&&this.quickOrderService.setListLimit(h)})),this.isCartStable$=Be([this.activeCartService.getActiveCartId(),this.activeCartService.isStable()]).pipe(A(([h,Rt])=>h?Rt:!0)),this.globalMessageType=R,this.cartErrors$=new I([]),this.cartWarnings$=new I([]),this.cartSuccesses$=new I([]),this.showAddToCartInformation$=new I(!1),this.nonPurchasableProductError$=new I(null)}ngOnInit(){this.cartId$=this.activeCartService.getActiveCartId(),this.entries$=this.quickOrderService.getEntries(),this.quickOrderStatePersistenceService.initSync()}ngOnDestroy(){this.quickOrderService.clearDeletedEntries()}get errors$(){return this.cartErrors$.asObservable()}get warnings$(){return this.cartWarnings$.asObservable()}get successes$(){return this.cartSuccesses$.asObservable()}get nonPurchasableError$(){return this.quickOrderService.getNonPurchasableProductError()}get addToCartInformation$(){return this.showAddToCartInformation$.asObservable()}get softDeletedEntries$(){return this.quickOrderService.getSoftDeletedEntries()}clear(){this.quickOrderService.clearList(),this.globalMessageService.add({key:"quickOrderTable.listCleared"},R.MSG_TYPE_INFO)}addToCart(e){if(!e.length){this.showAddToCartInformation$.next(!0);return}this.clearStatuses(),this.quickOrderService.addToCart().pipe(N()).subscribe(([t,n])=>{n.forEach(a=>{a.entry||(a.entry=e.find(C=>C.product?.code===a.productCode))}),this.extractErrors(n),this.extractWarnings(n),n.length?this.extractSuccesses(n,t):this.showAddedToCartSuccessMessage()})}clearErrors(){this.cartErrors$.next([])}clearWarnings(){this.cartWarnings$.next([])}clearSuccesses(){this.cartSuccesses$.next([])}clearAddToCartInformation(){this.showAddToCartInformation$.next(!1)}undoDeletion(e){e.product?.code&&this.quickOrderService.restoreSoftDeletedEntry(e.product.code)}clearDeletion(e){e.product?.code&&this.quickOrderService.hardDeleteEntry(e.product.code)}clearNonPurchasableError(){this.quickOrderService.clearNonPurchasableProductError()}canAddProduct(){return this.quickOrderService.canAdd()}extractErrors(e){let t=e.filter(n=>n.quantityAdded===0);this.setErrors(t)}extractWarnings(e){let t=e.filter(n=>n.quantityAdded!==0);this.setWarnings(t)}extractSuccesses(e,t){let n=[];t.forEach(a=>{e.find(h=>h.productCode===a.product?.code)||n.push(a)}),this.setSuccesses(n)}clearStatuses(){this.clearErrors(),this.clearWarnings(),this.clearSuccesses()}showAddedToCartSuccessMessage(){this.globalMessageService.add({key:"quickOrderTable.addedtoCart"},R.MSG_TYPE_CONFIRMATION)}setErrors(e){this.cartErrors$.next(e)}setWarnings(e){this.cartWarnings$.next(e)}setSuccesses(e){this.cartSuccesses$.next(e)}};r.\u0275fac=function(t){return new(t||r)(q(z),q(ht),q(ye),q(M),q(Ie))},r.\u0275cmp=j({type:r,selectors:[["cx-quick-order"]],viewQuery:function(t,n){if(t&1&&le(xi,5),t&2){let a;ue(a=pe())&&(n.quickOrderForm=a.first)}},decls:17,vars:24,consts:[["quickOrderForm",""],["aria-atomic","true","aria-live","assertive","aria-relevant","additions",1,"quick-order-message-container"],[4,"ngIf"],[1,"quick-order-list-limit-message",3,"text","isVisibleCloseButton","type"],[1,"quick-order-add-to-cart-information-message",3,"closeMessage","text","type"],[1,"quick-order-non-purchasable-product-error-message",3,"closeMessage","text","type"],["class","quick-order-deletions-message",3,"actionButtonText","actionButtonMessage","text","type","buttonAction","closeMessage",4,"ngFor","ngForOf"],[1,"quick-order-deletions-message",3,"buttonAction","closeMessage","actionButtonText","actionButtonMessage","text","type"],["class","quick-order-errors-message",3,"accordionText","text","type","closeMessage",4,"ngIf"],[1,"quick-order-errors-message",3,"closeMessage","accordionText","text","type"],[1,"quick-order-errors"],["class","quick-order-error-item",4,"ngFor","ngForOf"],[1,"cx-visually-hidden"],[1,"quick-order-error-item"],["class","quick-order-warnings-message",3,"accordionText","text","type","closeMessage",4,"ngIf"],[1,"quick-order-warnings-message",3,"closeMessage","accordionText","text","type"],[1,"quick-order-warnings"],["class","quick-order-warning-item",4,"ngFor","ngForOf"],[1,"quick-order-warning-item"],["class","quick-order-successes-message",3,"text","type","closeMessage",4,"ngIf"],[1,"quick-order-successes-message",3,"closeMessage","text","type"],[1,"quick-order-successes"],["class","quick-order-success-item",4,"ngFor","ngForOf"],[1,"quick-order-success-item"],[1,"quick-order-header"],[1,"quick-order-form-body"],[3,"limit"],[1,"quick-order-table-body"],[3,"entries","loading"],[1,"quick-order-footer","row"],[1,"col-xs-12","col-md-5","col-lg-3"],["class","btn btn-block btn-secondary clear-button","type","button",3,"disabled","click",4,"ngIf"],[3,"clickEvent","ariaLabel","loading"],["type","button",1,"btn","btn-block","btn-secondary","clear-button",3,"click","disabled"]],template:function(t,n){t&1&&(u(0,"div",1),_(1,vi,3,3,"ng-container",2),s(2,"async"),_(3,bi,3,4,"ng-container",2),s(4,"async"),_(5,Oi,3,7,"ng-container",2),s(6,"async"),_(7,Si,3,3,"ng-container",2),s(8,"async"),_(9,Fi,2,1,"ng-container",2),s(10,"async"),_(11,Pi,2,1,"ng-container",2),s(12,"async"),_(13,Ai,2,1,"ng-container",2),s(14,"async"),p(),_(15,Ri,3,3,"ng-container",2),s(16,"async")),t&2&&(c(),d("ngIf",l(2,8,n.entries$)),c(2),d("ngIf",l(4,10,n.addToCartInformation$)),c(2),d("ngIf",l(6,12,n.nonPurchasableError$)),c(2),d("ngIf",l(8,14,n.softDeletedEntries$)),c(2),d("ngIf",l(10,16,n.errors$)),c(2),d("ngIf",l(12,18,n.warnings$)),c(2),d("ngIf",l(14,20,n.successes$)),c(2),d("ngIf",l(16,22,n.quickOrderListLimit$)))},dependencies:[ee,K,qt,bt,Ni,Gi,te,He,G],encapsulation:2,changeDetection:0});let i=r;return i})(),Yi=(()=>{let r=class r{};r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=D({type:r}),r.\u0275inj=$({providers:[xe({cmsComponents:{QuickOrderComponent:{component:Wi,data:{quickOrderListLimit:10}}}})],imports:[xt,fe,we,Ce,ft,vt,yt,St,Ot,Te,he,st]});let i=r;return i})(),Dt=(()=>{let r=class r{};r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=D({type:r}),r.\u0275inj=$({providers:[{provide:Ft,useExisting:Vi}],imports:[he,Yi,Li]});let i=r;return i})();var kr=(()=>{let r=class r{};r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=D({type:r}),r.\u0275inj=$({imports:[Pt,Dt]});let i=r;return i})();export{kr as QuickOrderModule};
